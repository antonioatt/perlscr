#! /usr/bin/perl -w

# this is geared toward the way the ensembl dump is organized

@ARGV ||
    die "Usage:  $0  <file name> \n";

$filename = $ARGV[0];
open (IF, "<$filename" ) 
    || die "Cno $filename: $!.\n";

$home = `pwd`; chomp $home;
while ( <IF> ) {
    chomp;
    ($dbname) = split;
    print "$dbname\n";
    # $cmd = "mysqladmin -u root create $dbname";
    # (system $cmd) && die "error running $cmd\n";
    chdir $home;
    chdir $dbname;
    $cmd = "mysqlimport -u root --fields_escaped_by=\\ $dbname -L *.txt";

    (system $cmd) && warn "error running $cmd\n";
}

close IF;
